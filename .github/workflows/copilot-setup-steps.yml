name: Homelab â€“ Copilot Setup

on:
  workflow_dispatch:
  push:
    paths:
      - ".github/workflows/copilot-setup-steps.yml"
  pull_request:
    paths:
      - ".github/workflows/copilot-setup-steps.yml"

env:
  HOMELAB_TOOLING_IMAGE: ghcr.io/${{ toLower(github.repository) }}/fedora-ansible-43-ansible:latest

jobs:
  copilot-setup-steps:
    runs-on: ubuntu-latest
    container:
      image: ${{ env.HOMELAB_TOOLING_IMAGE }}

    permissions:
      contents: read

    steps:
      - name: Checkout repository
        uses: actions/checkout@v5

      - name: Verify tooling inside homelab image
        run: |
          echo "Using image: $HOMELAB_TOOLING_IMAGE"
          ansible --version
          ansible-lint --version
          yamllint --version
          python --version
          git --version
